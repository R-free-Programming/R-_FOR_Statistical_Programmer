<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R Classes - Learn R Programming</title>
    <meta name="description" content="R Classes - Comprehensive video courses for learning R programming from beginner to advanced levels.">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --danger-color: #e74c3c;
            --success-color: #2ecc71;
            --border-color: #ddd;
            --shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .hidden {
            display: none !important;
        }

        /* Login Page */
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            padding: 30px;
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .logo {
            margin-bottom: 30px;
        }

        .logo h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
            font-weight: 600;
        }

        .logo .tagline {
            color: var(--dark-color);
            font-size: 1.1rem;
            margin-top: 10px;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .btn {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
            text-decoration: none;
        }

        .btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .error-message {
            color: var(--danger-color);
            margin-top: 15px;
            padding: 10px;
            background: rgba(231, 76, 60, 0.1);
            border-radius: 4px;
        }

        /* Video Listing Page */
        header {
            background: var(--dark-color);
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        header h1 {
            font-size: 1.5rem;
        }

        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            padding: 30px;
        }

        .video-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            transition: all 0.3s;
            border-left: 4px solid var(--primary-color);
        }

        .video-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .video-thumbnail {
            position: relative;
            height: 180px;
            background: #e0e0e0;
            overflow: hidden;
        }

        .video-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .video-card:hover .video-thumbnail img {
            transform: scale(1.05);
        }

        .video-info {
            padding: 20px;
        }

        .video-info h3 {
            margin-bottom: 12px;
            color: var(--dark-color);
        }

        /* Admin Panel */
        .admin-container {
            display: flex;
            min-height: calc(100vh - 60px);
        }

        .admin-sidebar {
            width: 250px;
            background: var(--dark-color);
            color: white;
            padding: 20px 0;
        }

        .admin-sidebar ul {
            list-style: none;
        }

        .admin-sidebar li {
            padding: 12px 25px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .admin-sidebar li:hover {
            background: rgba(255, 255, 255, 0.1);
            border-left-color: var(--primary-color);
        }

        .admin-sidebar li.active {
            background: rgba(52, 152, 219, 0.2);
            border-left-color: var(--primary-color);
        }

        .admin-content {
            flex: 1;
            padding: 30px;
            background: var(--light-color);
        }

        .upload-area {
            border: 2px dashed var(--border-color);
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 8px;
            background: white;
            transition: all 0.3s;
        }

        .upload-area:hover {
            border-color: var(--primary-color);
            background: rgba(52, 152, 219, 0.05);
        }

        .video-list {
            margin-top: 30px;
        }

        .video-list-item {
            display: flex;
            justify-content: space-between;
            padding: 15px 20px;
            background: white;
            margin-bottom: 10px;
            border-radius: 4px;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        /* Video Player */
        .player-container {
            max-width: 900px;
            margin: 30px auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            margin-bottom: 25px;
            background: #000;
            border-radius: 4px;
        }

        .video-wrapper video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .recording-warning {
            background: var(--danger-color);
            color: white;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 4px;
            font-weight: 500;
        }

        /* Upload Progress */
        #uploadProgress {
            margin-top: 20px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 4px;
            border-left: 3px solid var(--primary-color);
        }

        #uploadProgressBar {
            width: 100%;
            height: 10px;
            margin: 15px 0;
            border-radius: 5px;
        }

        #uploadProgressBar::-webkit-progress-bar {
            background-color: #eee;
            border-radius: 5px;
        }

        #uploadProgressBar::-webkit-progress-value {
            background-color: var(--primary-color);
            border-radius: 5px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .login-container {
                margin: 40px 20px;
                padding: 30px;
            }
            
            .admin-container {
                flex-direction: column;
            }
            
            .admin-sidebar {
                width: 100%;
            }
            
            .video-grid {
                grid-template-columns: 1fr;
                padding: 20px;
            }
            
            header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .player-container {
                margin: 20px;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="login-container">
        <div class="logo">
            <h1>R Classes</h1>
            <p class="tagline">Master R Programming with Shubham</p>
        </div>
        <form id="loginForm">
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" required placeholder="Enter your username">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required placeholder="Enter your password">
            </div>
            <button type="submit" class="btn">Login</button>
            <div id="loginError" class="error-message hidden"></div>
        </form>
    </div>

    <!-- Video Listing Page -->
    <div id="videosPage" class="hidden">
        <header>
            <h1>Learn R with Shubham R Classes!</h1>
            <nav>
                <button id="logoutBtn" class="btn">Logout</button>
                <button id="adminBtn" class="btn hidden">Admin Panel</button>
            </nav>
        </header>
        <main>
            <div class="video-grid" id="videoGrid">
                <!-- Videos will be loaded here -->
            </div>
        </main>
    </div>

    <!-- Admin Panel -->
    <div id="adminPage" class="hidden">
        <header>
            <h1>R Classes Admin Panel</h1>
            <nav>
                <button id="backToVideosBtn" class="btn">Back to Videos</button>
                <button id="adminLogoutBtn" class="btn">Logout</button>
            </nav>
        </header>
        <div class="admin-container">
            <div class="admin-sidebar">
                <ul>
                    <li class="active" data-section="upload">Upload Videos</li>
                    <li data-section="manage">Manage Videos</li>
                </ul>
            </div>
            <div class="admin-content">
                <div id="uploadSection">
                    <h2>Upload New Video</h2>
                    <div class="upload-area" id="dropArea">
                        <p>Drag & drop video files here or</p>
                        <input type="file" id="videoUpload" accept="video/*" style="display: none;">
                        <button class="btn" id="selectFilesBtn">Select Files</button>
                    </div>
                    <div id="uploadProgress" class="hidden">
                        <p>Uploading: <span id="uploadFileName"></span></p>
                        <progress id="uploadProgressBar" value="0" max="100"></progress>
                        <p id="uploadStatus"></p>
                    </div>
                </div>
                <div id="manageSection" class="hidden">
                    <h2>Manage Videos</h2>
                    <div class="video-list" id="adminVideoList">
                        <!-- Admin video list will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Player -->
    <div id="playerPage" class="hidden">
        <header>
            <h1>R Classes Video Player</h1>
            <nav>
                <button id="backFromPlayerBtn" class="btn">Back to Videos</button>
                <button id="playerLogoutBtn" class="btn">Logout</button>
            </nav>
        </header>
        <div class="player-container">
            <div id="recordingWarning" class="recording-warning hidden">
                Screen recording detected! Video playback has been disabled.
            </div>
            <div class="video-wrapper">
                <video id="secureVideoPlayer" controls>
                    Your browser does not support the video tag.
                </video>
            </div>
            <h2 id="videoTitle">Sample Video</h2>
            <p id="videoDescription">This is a sample video description.</p>
        </div>
    </div>

    <script>
        // Simulated database with correct credentials
        const users = [
            { username: 'sharoon', password: 'shubham', role: 'admin' },
            { username: 'r class', password: 'batch 1', role: 'user' }
        ];

        let videos = [
            {
                id: 1,
                title: "Introduction to R Programming",
                thumbnail: "https://via.placeholder.com/300x180.png/276dc1/ffffff?text=R+Intro",
                url: "https://example.com/videos/intro.mp4",
                description: "Learn the basics of R programming language"
            },
            {
                id: 2,
                title: "Data Visualization in R",
                thumbnail: "https://via.placeholder.com/300x180.png/276dc1/ffffff?text=Data+Viz",
                url: "https://example.com/videos/visualization.mp4",
                description: "Master ggplot2 and other visualization tools"
            }
        ];

        // Current user session
        let currentUser = null;
        let currentSessionToken = null;

        // DOM Elements
        const loginPage = document.getElementById('loginPage');
        const videosPage = document.getElementById('videosPage');
        const adminPage = document.getElementById('adminPage');
        const playerPage = document.getElementById('playerPage');
        const loginForm = document.getElementById('loginForm');
        const loginError = document.getElementById('loginError');
        const logoutBtn = document.getElementById('logoutBtn');
        const adminBtn = document.getElementById('adminBtn');
        const backToVideosBtn = document.getElementById('backToVideosBtn');
        const adminLogoutBtn = document.getElementById('adminLogoutBtn');
        const backFromPlayerBtn = document.getElementById('backFromPlayerBtn');
        const playerLogoutBtn = document.getElementById('playerLogoutBtn');
        const videoGrid = document.getElementById('videoGrid');
        const secureVideoPlayer = document.getElementById('secureVideoPlayer');
        const videoTitle = document.getElementById('videoTitle');
        const videoDescription = document.getElementById('videoDescription');
        const recordingWarning = document.getElementById('recordingWarning');
        const uploadSection = document.getElementById('uploadSection');
        const manageSection = document.getElementById('manageSection');
        const adminVideoList = document.getElementById('adminVideoList');
        const videoUpload = document.getElementById('videoUpload');
        const dropArea = document.getElementById('dropArea');
        const selectFilesBtn = document.getElementById('selectFilesBtn');
        const uploadProgress = document.getElementById('uploadProgress');
        const uploadFileName = document.getElementById('uploadFileName');
        const uploadProgressBar = document.getElementById('uploadProgressBar');
        const uploadStatus = document.getElementById('uploadStatus');

        // Reset video player function
        function resetVideoPlayer() {
            secureVideoPlayer.pause();
            secureVideoPlayer.currentTime = 0;
            secureVideoPlayer.removeAttribute('src');
            secureVideoPlayer.load();
            videoTitle.textContent = '';
            videoDescription.textContent = '';
        }

        // Generate random session token
        function generateSessionToken() {
            return 'token-' + Math.random().toString(36).substr(2, 16);
        }

        // Show login page
        function showLoginPage() {
            resetVideoPlayer();
            loginPage.classList.remove('hidden');
            videosPage.classList.add('hidden');
            adminPage.classList.add('hidden');
            playerPage.classList.add('hidden');
        }

        // Show videos page
        function showVideosPage() {
            resetVideoPlayer();
            loginPage.classList.add('hidden');
            videosPage.classList.remove('hidden');
            adminPage.classList.add('hidden');
            playerPage.classList.add('hidden');
            
            if (currentUser && currentUser.role === 'admin') {
                adminBtn.classList.remove('hidden');
            } else {
                adminBtn.classList.add('hidden');
            }
            
            renderVideoGrid();
        }

        // Show admin page
        function showAdminPage() {
            resetVideoPlayer();
            if (!currentUser || currentUser.role !== 'admin') {
                alert('You do not have admin privileges');
                return;
            }
            
            loginPage.classList.add('hidden');
            videosPage.classList.add('hidden');
            adminPage.classList.remove('hidden');
            playerPage.classList.add('hidden');
            
            document.querySelectorAll('.admin-sidebar li').forEach(i => i.classList.remove('active'));
            document.querySelector('.admin-sidebar li[data-section="upload"]').classList.add('active');
            uploadSection.classList.remove('hidden');
            manageSection.classList.add('hidden');
        }

        // Show video player
        function showVideoPlayer(videoId) {
            const video = videos.find(v => v.id === videoId);
            if (!video) return;
            
            loginPage.classList.add('hidden');
            videosPage.classList.add('hidden');
            adminPage.classList.add('hidden');
            playerPage.classList.remove('hidden');
            
            videoTitle.textContent = video.title;
            videoDescription.textContent = video.description;
            
            secureVideoPlayer.innerHTML = `
                <source src="${video.url}" type="video/mp4">
                Your browser does not support MP4 videos.
            `;
            secureVideoPlayer.load();
            secureVideoPlayer.controls = true;
            secureVideoPlayer.controlsList = 'nodownload';
            
            secureVideoPlayer.addEventListener('error', () => {
                alert('Error loading video. Please try again later.');
                showVideosPage();
            });
        }

        // Render video grid
        function renderVideoGrid() {
            videoGrid.innerHTML = '';
            
            if (videos.length === 0) {
                videoGrid.innerHTML = `
                    <div class="empty-state">
                        <p>No videos available</p>
                        ${currentUser?.role === 'admin' ? 
                            '<p>Upload videos using the admin panel</p>' : 
                            '<p>Contact administrator to upload videos</p>'}
                    </div>
                `;
                return;
            }
            
            videos.forEach(video => {
                const videoCard = document.createElement('div');
                videoCard.className = 'video-card';
                videoCard.innerHTML = ` 
                    <div class="video-thumbnail">
                        <img src="${video.thumbnail}" alt="${video.title}">
                    </div>
                    <div class="video-info">
                        <h3>${video.title}</h3>
                        <button class="btn" onclick="showVideoPlayer(${video.id})">Play Video</button>
                    </div>
                `;
                videoGrid.appendChild(videoCard);
            });
        }

        // Handle login
        function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                currentUser = user;
                currentSessionToken = generateSessionToken();
                
                localStorage.setItem('currentUser', JSON.stringify(user));
                localStorage.setItem('sessionToken', currentSessionToken);
                
                loginError.style.display = 'none';
                showVideosPage();
            } else {
                loginError.textContent = 'Invalid username or password';
                loginError.style.display = 'block';
                loginError.classList.remove('hidden');
            }
        }

        // Handle logout
        function handleLogout() {
            videos.forEach(video => {
                if (video.url.startsWith('blob:')) {
                    URL.revokeObjectURL(video.url);
                }
            });
            
            resetVideoPlayer();
            currentUser = null;
            currentSessionToken = null;
            localStorage.removeItem('currentUser');
            localStorage.removeItem('sessionToken');
            showLoginPage();
        }

        // Prevent default drag and drop behavior
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        // Highlight drop area
        function highlight() {
            dropArea.style.borderColor = 'var(--primary-color)';
            dropArea.style.backgroundColor = 'rgba(39, 109, 193, 0.1)';
        }

        // Unhighlight drop area
        function unhighlight() {
            dropArea.style.borderColor = '#ccc';
            dropArea.style.backgroundColor = '';
        }

        // Handle dropped files
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        // Handle selected files
        function handleFiles(files) {
            if (files.length > 0) {
                const file = files[0];
                if (file.type === 'video/mp4' || file.name.toLowerCase().endsWith('.mp4')) {
                    simulateUpload(file);
                } else {
                    alert('Please upload only MP4 video files (.mp4)');
                }
            }
        }

        // Handle file upload
        function handleFileUpload(e) {
            handleFiles(e.target.files);
        }

        // Simulate file upload
        function simulateUpload(file) {
            uploadProgress.classList.remove('hidden');
            uploadFileName.textContent = file.name;
            uploadProgressBar.value = 0;
            uploadStatus.textContent = 'Starting upload...';

            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress > 100) progress = 100;
                uploadProgressBar.value = progress;
                uploadStatus.textContent = `Uploading... ${Math.round(progress)}%`;

                if (progress === 100) {
                    clearInterval(interval);
                    uploadStatus.textContent = 'Upload complete! Processing video...';
                    
                    setTimeout(() => {
                        const videoUrl = URL.createObjectURL(file);
                        const newVideo = {
                            id: videos.length > 0 ? Math.max(...videos.map(v => v.id)) + 1 : 1,
                            title: file.name.replace(/\.mp4$/i, "").replace(/_/g, " "),
                            thumbnail: 'https://via.placeholder.com/300x180.png/276dc1/ffffff?text=New+Video',
                            url: videoUrl,
                            description: `Uploaded on ${new Date().toLocaleDateString()} by ${currentUser.username}`
                        };
                        
                        videos.push(newVideo);
                        uploadStatus.textContent = 'Video ready!';
                        
                        loadAdminVideoList();
                        renderVideoGrid();
                        
                        setTimeout(() => {
                            uploadProgress.classList.add('hidden');
                            videoUpload.value = '';
                        }, 1500);
                    }, 1500);
                }
            }, 200);
        }

        // Load admin video list
        function loadAdminVideoList() {
            adminVideoList.innerHTML = '';
            
            if (videos.length === 0) {
                adminVideoList.innerHTML = '<p class="empty-state">No videos uploaded yet</p>';
                return;
            }
            
            videos.forEach(video => {
                const videoItem = document.createElement('div');
                videoItem.className = 'video-list-item';
                videoItem.innerHTML = ` 
                    <div class="video-info">
                        <h3>${video.title}</h3>
                        <p>ID: ${video.id} | ${video.description}</p>
                    </div>
                    <div class="actions">
                        <button class="btn" style="background-color: var(--danger-color);" onclick="deleteVideo(${video.id})">Delete</button>
                    </div>
                `;
                adminVideoList.appendChild(videoItem);
            });
        }

        // Delete video
        function deleteVideo(id) {
            if (confirm('Are you sure you want to delete this video?')) {
                const index = videos.findIndex(v => v.id === id);
                if (index !== -1) {
                    if (videos[index].url.startsWith('blob:')) {
                        URL.revokeObjectURL(videos[index].url);
                    }
                    videos.splice(index, 1);
                    loadAdminVideoList();
                    renderVideoGrid();
                }
            }
        }

        // Initialize the app
        function init() {
            // Check if user is already logged in
            const sessionToken = localStorage.getItem('sessionToken');
            if (sessionToken) {
                try {
                    currentUser = JSON.parse(localStorage.getItem('currentUser'));
                    currentSessionToken = sessionToken;
                    showVideosPage();
                } catch (e) {
                    handleLogout();
                }
            } else {
                showLoginPage();
            }

            // Event listeners
            loginForm.addEventListener('submit', handleLogin);
            logoutBtn.addEventListener('click', handleLogout);
            adminBtn.addEventListener('click', showAdminPage);
            backToVideosBtn.addEventListener('click', showVideosPage);
            adminLogoutBtn.addEventListener('click', handleLogout);
            backFromPlayerBtn.addEventListener('click', () => {
                resetVideoPlayer();
                showVideosPage();
            });
            playerLogoutBtn.addEventListener('click', handleLogout);
            videoUpload.addEventListener('change', handleFileUpload);
            selectFilesBtn.addEventListener('click', () => videoUpload.click());

            // Drag and drop for upload
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });

            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, unhighlight, false);
            });

            dropArea.addEventListener('drop', handleDrop, false);

            // Admin sidebar navigation
            document.querySelectorAll('.admin-sidebar li').forEach(item => {
                item.addEventListener('click', () => {
                    document.querySelectorAll('.admin-sidebar li').forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    
                    if (item.dataset.section === 'upload') {
                        uploadSection.classList.remove('hidden');
                        manageSection.classList.add('hidden');
                    } else {
                        uploadSection.classList.add('hidden');
                        manageSection.classList.remove('hidden');
                        loadAdminVideoList();
                    }
                });
            });

            // Initialize video grid
            renderVideoGrid();
        }

        // Start the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);

        // Make functions available globally for HTML event handlers
        window.showVideoPlayer = showVideoPlayer;
        window.deleteVideo = deleteVideo;
    </script>
</body>
</html>